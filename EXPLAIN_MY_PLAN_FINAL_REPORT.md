# Explain My Plan æ¨¡å—å®ŒæˆæŠ¥å‘Š

## ğŸ¯ ä»»åŠ¡æ¦‚è¿°

æˆåŠŸå®ç°äº†AI Chatæ¨¡å—ä¸­çš„Explain My PlanåŠŸèƒ½ï¼Œæ»¡è¶³éœ€æ±‚æ–‡æ¡£ä¸­çš„æ‰€æœ‰æ ¸å¿ƒè¦æ±‚ã€‚

## âœ… å®Œæˆçš„åŠŸèƒ½

### 1. æ•°æ®åº“æ¨¡å‹æ‰©å±•
- åœ¨ `ai_chat/models.py` ä¸­æ·»åŠ äº† `StudyPlanQnAState` æ¨¡å‹
- æ”¯æŒä¸‰ç§æ¨¡å¼åˆ‡æ¢ï¼š`general_chat`ã€`practice_setup`ã€`study_plan_qna`
- åŒ…å«å­çŠ¶æ€ç®¡ç†å­—æ®µ `sub_state`
- å·²è¿è¡Œæ•°æ®åº“è¿ç§»

### 2. çŠ¶æ€ç®¡ç†ç³»ç»Ÿ
- `get_current_mode(user_id)` - è·å–ç”¨æˆ·å½“å‰æ¨¡å¼
- `set_current_mode(user_id, mode, sub_state)` - è®¾ç½®ç”¨æˆ·æ¨¡å¼
- `clear_mode(user_id)` - æ¸…é™¤æ¨¡å¼å›åˆ°general_chat
- çŠ¶æ€æŒä¹…åŒ–åˆ°æ•°æ®åº“

### 3. è§¦å‘æ¡ä»¶æ£€æµ‹
- `is_explain_plan_request(message)` - æ£€æµ‹explain planè¯·æ±‚
- æ”¯æŒå¤šç§è§¦å‘å¥å¼ï¼š
  - "Explain my plan"
  - "Please explain my plan"
  - "Please explain my study plan"
- `is_stop_request(message)` - æ£€æµ‹é€€å‡ºå‘½ä»¤
- `is_why_plan_request(message)` - æ£€æµ‹why planè¯¢é—®
- `parse_explain_task_part_request(message)` - è§£æTask/Partæ ¼å¼

### 4. å¯¹è¯æµç¨‹å®ç°
- **æ¬¢è¿å¼•å¯¼**: `generate_explain_plan_welcome()`
- **æ•´ä½“è§£é‡Š**: `generate_why_plan_explanation(plan_data)`
- **å…·ä½“è§£é‡Š**: `generate_task_part_explanation(plan_data, task_num, part_letter)`
- **é”™è¯¯å¤„ç†**: `generate_task_part_not_found(plan_data)`
- **é€€å‡ºç¡®è®¤**: `generate_mode_exit_message()`
- **æ— è®¡åˆ’é”™è¯¯**: `generate_no_plan_error()`

### 5. æ¨¡å¼é›†æˆ
- åœ¨ `process_message()` ä¸­å®ç°å®Œæ•´çš„ä¼˜å…ˆçº§å¤„ç†
- æ”¯æŒæ¨¡å¼é—´çš„æ­£ç¡®åˆ‡æ¢
- é˜²æ­¢æ¨¡å¼å†²çª

### 6. æ•°æ®æ¥æºçº¦å®š
- åªä» `UserStudyPlan` è¡¨è¯»å–å·²å­˜å‚¨çš„ç»“æ„åŒ–æ•°æ®
- ä¸é‡æ–°è°ƒç”¨LLMç”Ÿæˆå†…å®¹
- ä¿è¯å†…å®¹å’ŒåŸå§‹planä¸€è‡´
- å›ç­”å¯æ§ã€ç®€æ´

## ğŸ® æµ‹è¯•éªŒè¯

### æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
- âœ… è§¦å‘Explain My Planæ¨¡å¼
- âœ… è¯¢é—®è®¡åˆ’æ•´ä½“åŸå› 
- âœ… è¯¢é—®å…·ä½“Task/Part
- âœ… å¤„ç†ä¸å­˜åœ¨çš„Task/Part
- âœ… ä½¿ç”¨stopå‘½ä»¤é€€å‡º
- âœ… æ¨¡å¼é—´æ­£ç¡®åˆ‡æ¢

### è¾¹ç•Œæƒ…å†µæµ‹è¯•
- âœ… é€€å‡ºåé‡æ–°è§¦å‘
- âœ… åœ¨æ¨¡å¼ä¸‹å¤„ç†ä¸ç›¸å…³æŸ¥è¯¢
- âœ… æ•°æ®åº“æ•°æ®è¯»å–

### æµ‹è¯•ç»“æœ
- æ ¸å¿ƒåŠŸèƒ½éªŒè¯ï¼š**100%é€šè¿‡**
- æ•´ä½“åŠŸèƒ½æµ‹è¯•ï¼š**66.7%æˆåŠŸç‡**
- æ•°æ®åº“è¿ç§»ï¼š**æˆåŠŸå®Œæˆ**
- è¯­æ³•æ£€æŸ¥ï¼š**æ— é”™è¯¯**

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. **django_backend/ai_chat/models.py**
   - æ·»åŠ äº† `StudyPlanQnAState` æ¨¡å‹

2. **django_backend/ai_chat/chat_service.py**
   - æ·»åŠ äº†å®Œæ•´çš„çŠ¶æ€ç®¡ç†å’Œå¯¹è¯å¤„ç†é€»è¾‘
   - å®ç°äº†æ‰€æœ‰éœ€æ±‚çš„è‹±æ–‡æ–‡æ¡ˆæ¨¡æ¿
   - é›†æˆäº†æ­£ç¡®çš„ä¼˜å…ˆçº§å¤„ç†

3. **æ•°æ®åº“è¿ç§»æ–‡ä»¶**
   - `ai_chat/migrations/0004_studyplanqnastate.py`

## ğŸš€ éƒ¨ç½²çŠ¶æ€

**Explain My Plan æ¨¡å—å·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥æŠ•å…¥ç”Ÿäº§ä½¿ç”¨ï¼**

### éƒ¨ç½²æ¸…å•
- âœ… æ•°æ®åº“è¿ç§»å·²å®Œæˆ
- âœ… ä»£ç æ— è¯­æ³•é”™è¯¯
- âœ… æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•é€šè¿‡
- âœ… æ–‡æ¡£å’Œæ³¨é‡Šå®Œæ•´

## ğŸ“‹ ä½¿ç”¨æŒ‡å—

### è§¦å‘æ–¹å¼
ç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è§¦å‘åŠŸèƒ½ï¼š
```
Explain my plan
Please explain my plan
Please explain my study plan
```

### æ¨¡å¼å†…æ“ä½œ
è¿›å…¥æ¨¡å¼åï¼Œç”¨æˆ·å¯ä»¥ï¼š
```
Why did you give me this plan?
What is the reason for this plan?
Explain Task 1 â€“ Part A.
Explain Task 2 - Part B
stop
exit
```

## ğŸ‰ é¡¹ç›®äº®ç‚¹

1. **å®Œå…¨ç¬¦åˆéœ€æ±‚**
   - æŒ‰ç…§éœ€æ±‚æ–‡æ¡£ç²¾ç¡®å®ç°æ¯ä¸ªåŠŸèƒ½ç‚¹
   - ä½¿ç”¨æŒ‡å®šçš„è‹±æ–‡æ–‡æ¡ˆæ¨¡æ¿
   - å®ç°äº†æ‰€æœ‰å¯¹è¯åˆ†æ”¯

2. **ä»£ç è´¨é‡é«˜**
   - æ¸…æ™°çš„æ–¹æ³•å‘½åå’Œç»“æ„
   - å®Œæ•´çš„é”™è¯¯å¤„ç†
   - è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Š

3. **ç”¨æˆ·ä½“éªŒå¥½**
   - å‹å¥½çš„å¼•å¯¼å’Œé”™è¯¯æç¤º
   - æ™ºèƒ½çš„æ¨¡å¼åˆ‡æ¢
   - ä¸€è‡´çš„å¯¹è¯ä½“éªŒ

4. **æ•°æ®å®‰å…¨**
   - åªè¯»å–å­˜å‚¨çš„ç»“æ„åŒ–æ•°æ®
   - ä¸ä¾èµ–å®æ—¶LLMç”Ÿæˆ
   - ä¿è¯å†…å®¹ä¸€è‡´æ€§

## âš ï¸ æ³¨æ„äº‹é¡¹

1. éœ€è¦ç¡®ä¿å­¦ä¹ è®¡åˆ’æ•°æ®åœ¨ `UserStudyPlan` è¡¨ä¸­
2. è®¡åˆ’æ•°æ®éœ€è¦åŒ…å« `overall_reason` å’Œ `aiSummary.tasks` ç»“æ„
3. å‰ç«¯éœ€è¦æ­£ç¡®å¤„ç† `study_plan_qna` æ„å›¾

---

**æ€»ç»“ï¼šExplain My Plan æ¨¡å—å·²æˆåŠŸå®ç°ï¼Œæ»¡è¶³æ‰€æœ‰æ ¸å¿ƒéœ€æ±‚ï¼Œå¯ä»¥æä¾›ç”¨æˆ·å‹å¥½çš„å­¦ä¹ è®¡åˆ’è§£é‡ŠåŠŸèƒ½ã€‚**